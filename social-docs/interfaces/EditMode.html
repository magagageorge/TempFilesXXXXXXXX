<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>woorbi documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">woorbi documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li>EditMode</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/services/edit-page.service.ts</code>
        </p>



        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#contacts">contacts</a>
                                </li>
                                <li>
                                        <a href="#coverEdit">coverEdit</a>
                                </li>
                                <li>
                                        <a href="#currentEditing">currentEditing</a>
                                </li>
                                <li>
                                        <a href="#inEdit">inEdit</a>
                                </li>
                                <li>
                                        <a href="#pictureEdit">pictureEdit</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="contacts"></a>
                                        <span class="name"><b>contacts</b><a href="#contacts"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>contacts:     <code>literal type</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>literal type</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="coverEdit"></a>
                                        <span class="name"><b>coverEdit</b><a href="#coverEdit"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>coverEdit:     <code>literal type</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>literal type</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="currentEditing"></a>
                                        <span class="name"><b>currentEditing</b><a href="#currentEditing"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>currentEditing:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="inEdit"></a>
                                        <span class="name"><b>inEdit</b><a href="#inEdit"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>inEdit:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="pictureEdit"></a>
                                        <span class="name"><b>pictureEdit</b><a href="#pictureEdit"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>pictureEdit:     <code>literal type</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>literal type</code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, Inject } from &#x27;@angular/core&#x27;;
import { WorkExperience } from &#x27;@app/models/profile/work-experience&#x27;;
import { CrudService, CrudProvider, CRUD_OPTIONS, CrudOptions } from &#x27;@app/@crud&#x27;;
import { UrlViewerService } from &#x27;./url-viewer.service&#x27;;
import { PageService } from &#x27;./page.service&#x27;;
import { LoadSubmitProgressService } from &#x27;./load-submit-progress.service&#x27;;
import { HttpClient } from &#x27;@angular/common/http&#x27;;
import { Router } from &#x27;@angular/router&#x27;;
import { NgxImageCompressService } from &#x27;ngx-image-compress&#x27;;
import { SysFunctions } from &#x27;@app/libs/utilities/common-functions&#x27;;
import { Observable } from &#x27;rxjs&#x27;;
import { getDeepFromObject } from &#x27;@app/@crud/helpers&#x27;;
import { PageFeedService } from &#x27;@app/viewer/page/services/page-feed.service&#x27;;
import { FeedService } from &#x27;./feed.service&#x27;;

export interface EditMode {
  inEdit: boolean;
  currentEditing: string;
  coverEdit: {
    selectOptions: boolean;
    selectedOption: string;
    processingCover: boolean;
  }
  pictureEdit: {
    selectOptions: boolean;
    selectedOption: string;
    processingPicture: boolean;
  },
  contacts: {
    action: string;
    inEditData: any;
    processingContacts: boolean;
  }
}

export interface DeleteMode {
  inDelete: boolean;
  currentDeleting: string;
}

export interface PreviewPicture {
  url: string;
  width: number;
  height: number;
  file: File;
  isNew: boolean;
}

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class EditPageService {

  service: CrudService;
  crudprovider: CrudProvider;
  urlViewerService: UrlViewerService;
  pageService: PageService;
  loadProcessService: LoadSubmitProgressService;
  httpClient: HttpClient;
  protected crudconfig: {};
  protected router: Router;
  redirectDelay: number;
  showMessages: any;
  provider: string;
  submitted: boolean;
  errors: string[];
  messages: string[];
  imageCompress: NgxImageCompressService;
  //public PAGE: Page &#x3D; new Page();
  loading_page: boolean &#x3D; false;
  cover_preview_info: PreviewPicture &#x3D; { url: &#x27;&#x27;, width: 0, height: 0, file: null, isNew: true };
  picture_preview_info: PreviewPicture &#x3D; { url: &#x27;&#x27;, width: 0, height: 0, file: null, isNew: true };
  editMode: EditMode &#x3D; { inEdit: false, currentEditing: &#x27;&#x27;, coverEdit: { selectOptions: false, selectedOption: &#x27;&#x27;, processingCover: false }, pictureEdit: { selectOptions: false, selectedOption: &#x27;&#x27;, processingPicture: false }, contacts: { action: &#x27;&#x27;, inEditData: null, processingContacts: false } };
  deleteMode: DeleteMode &#x3D; { inDelete: false, currentDeleting: &#x27;&#x27; };
  uploadingImage: boolean &#x3D; false;
  processingImage: boolean &#x3D; false;
  loadingImage: boolean &#x3D; false;

  constructor(service: CrudService, public feedService: FeedService, public pageFeedService: PageFeedService, pageService: PageService, urlViewerService: UrlViewerService, loadProcessService: LoadSubmitProgressService, imageCompress: NgxImageCompressService, @Inject(CRUD_OPTIONS) CRUD_OPTIONS: CrudOptions, router: Router, httpClient: HttpClient) {
    this.service &#x3D; service;
    this.crudconfig &#x3D; CRUD_OPTIONS;
    this.router &#x3D; router;
    this.httpClient &#x3D; httpClient;
    this.imageCompress &#x3D; imageCompress;
    this.urlViewerService &#x3D; urlViewerService;
    this.pageService &#x3D; pageService;
    this.loadProcessService &#x3D; loadProcessService;
  }

  editCover() {
    this.editMode.inEdit &#x3D; true;
    this.editMode.currentEditing &#x3D; &#x27;pageCover&#x27;;
    this.editMode.coverEdit.selectOptions &#x3D; true;
  }

  cancelEditCover() {
    this.editMode.inEdit &#x3D; false;
    this.editMode.currentEditing &#x3D; &#x27;&#x27;;
    this.editMode.coverEdit.selectOptions &#x3D; false;
    this.editMode.coverEdit.selectedOption &#x3D; &#x27;&#x27;;
  }

  editPicture() {
    this.editMode.inEdit &#x3D; true;
    this.editMode.currentEditing &#x3D; &#x27;pagePicture&#x27;;
    this.editMode.pictureEdit.selectOptions &#x3D; true;
  }

  cancelEditPicture() {
    this.editMode.inEdit &#x3D; false;
    this.editMode.currentEditing &#x3D; &#x27;&#x27;;
    this.editMode.pictureEdit.selectOptions &#x3D; false;
    this.editMode.pictureEdit.selectedOption &#x3D; &#x27;&#x27;;
  }

  savePageCover(base64CoverUri: any) {
    var _this &#x3D; this;
    this.uploadingImage &#x3D; true;
    var cropped_image &#x3D; SysFunctions.DataUrlToFile(base64CoverUri);
    this.errors &#x3D; this.messages &#x3D; [];
    const formData: any &#x3D; new FormData();
    this.provider &#x3D; this.getConfigValue(&#x27;forms.update.provider&#x27;);
    this.service.getProvider(this.provider).crudconfig.route_url &#x3D; &#x27;page/page-cover/&#x27;;
    if (this.cover_preview_info.isNew &#x3D;&#x3D; true &amp;&amp; this.cover_preview_info.file !&#x3D; null) {
      formData.append(&quot;PageCoverForm[org_image]&quot;, this.cover_preview_info.file);
    }
    formData.append(&quot;PageCoverForm[image]&quot;, cropped_image);
    formData.append(&quot;wh_ratio&quot;, 0);

    this.service.update(this.provider, formData, { id: this.urlViewerService.PPVIEWER.page.id }).subscribe(function (result) {
      _this.submitted &#x3D; false;
      if (result.isSuccess()) {
        _this.messages &#x3D; result.getMessages();
        var data &#x3D; result.getResultData();
        if (data.done &#x3D;&#x3D; true) {
          _this.urlViewerService.PPVIEWER.page.cover.picture &#x3D; base64CoverUri;
          _this.cover_preview_info &#x3D; { url: &#x27;&#x27;, width: 0, height: 0, file: null, isNew: true };
          if (data.post !&#x3D; null) {
            if (data.post !&#x3D; null) {
              _this.feedService.prependFeed(data.post, false);
              if (data.post.page !&#x3D; null &amp;&amp; data.post.page.id &#x3D;&#x3D; _this.pageFeedService.page_id) {
                _this.pageFeedService.prependFeed(data.post, false);
              }
            }
          }
        }
      } else {
        _this.errors &#x3D; result.getErrors();
      }
      _this.uploadingImage &#x3D; false;
    });

    this.cancelEditCover();
  }

  savePagePicture(base64PictureUri: any) {
    var _this &#x3D; this;
    this.uploadingImage &#x3D; true;
    var cropped_image &#x3D; SysFunctions.DataUrlToFile(base64PictureUri);
    this.errors &#x3D; this.messages &#x3D; [];
    const formData: any &#x3D; new FormData();
    this.provider &#x3D; this.getConfigValue(&#x27;forms.update.provider&#x27;);
    this.service.getProvider(this.provider).crudconfig.route_url &#x3D; &#x27;page/page-picture/&#x27;;

    if (this.picture_preview_info.isNew &#x3D;&#x3D; true &amp;&amp; this.picture_preview_info.file !&#x3D; null) {
      formData.append(&quot;PagePictureForm[org_image]&quot;, this.picture_preview_info.file);
    }
    formData.append(&quot;PagePictureForm[image]&quot;, cropped_image);
    formData.append(&quot;wh_ratio&quot;, 0);

    this.service.update(this.provider, formData, { id: this.urlViewerService.PPVIEWER.page.id }).subscribe(function (result) {
      _this.submitted &#x3D; false;
      if (result.isSuccess()) {
        _this.messages &#x3D; result.getMessages();
        var data &#x3D; result.getResultData();
        if (data.done &#x3D;&#x3D; true) {
          _this.urlViewerService.PPVIEWER.page.picture.face &#x3D; base64PictureUri;
          _this.picture_preview_info &#x3D; { url: &#x27;&#x27;, width: 0, height: 0, file: null, isNew: true };
          if (data.post !&#x3D; null) {
            _this.feedService.prependFeed(data.post, false);
            if (data.post.page !&#x3D; null &amp;&amp; data.post.page.id &#x3D;&#x3D; _this.pageFeedService.page_id) {
              _this.pageFeedService.prependFeed(data.post, false);
            }
          }
        }
      } else {
        _this.errors &#x3D; result.getErrors();
      }
      _this.uploadingImage &#x3D; false;
    });

    this.cancelEditPicture();
  }

  postponeAddingPicture() {
    var _this &#x3D; this;
    this.errors &#x3D; this.messages &#x3D; [];
    const formData: any &#x3D; new FormData();
    this.provider &#x3D; this.getConfigValue(&#x27;forms.update.provider&#x27;);
    this.service.getProvider(this.provider).crudconfig.route_url &#x3D; &#x27;page/page-picture/&#x27;;
    //this.pageService.MYPAGE.avatar.show_alert &#x3D; false;
    formData.append(&quot;SkipPagePicture&quot;, true);
    this.service.update(this.provider, formData, {}).subscribe(function (result) {
      _this.submitted &#x3D; false;
      if (result.isSuccess()) {
        _this.messages &#x3D; result.getMessages();
        var data &#x3D; result.getResultData();
      } else {
        _this.errors &#x3D; result.getErrors();
      }
    });
  }

  postponeAddingCover() {
    var _this &#x3D; this;
    this.errors &#x3D; this.messages &#x3D; [];
    const formData: any &#x3D; new FormData();
    this.provider &#x3D; this.getConfigValue(&#x27;forms.update.provider&#x27;);
    this.service.getProvider(this.provider).crudconfig.route_url &#x3D; &#x27;page/page-cover/&#x27;;
    //this.pageService.MYPAGE.cover.show_alert &#x3D; false;
    formData.append(&quot;SkipPageCover&quot;, true);
    this.service.update(this.provider, formData, {}).subscribe(function (result) {
      _this.submitted &#x3D; false;
      if (result.isSuccess()) {
        _this.messages &#x3D; result.getMessages();
        var data &#x3D; result.getResultData();
      } else {
        _this.errors &#x3D; result.getErrors();
      }
    });
  }

  onSelectCoverFile(event) {
    if (event.target.files &amp;&amp; event.target.files[0]) {
      //this.filesToUpload &#x3D; this.filesToUpload.concat(&lt;Array&lt;File&gt;&gt;event.target.files);
      var filesAmount &#x3D; event.target.files.length;
      let files &#x3D; event.target.files;
      for (let i &#x3D; 0; i &lt; filesAmount; i++) {
        var f &#x3D; files[i];
        // Only process image files.
        if (!f.type.match(&#x27;image.*&#x27;)) {
          continue;
        }
        this.editMode.coverEdit.selectOptions &#x3D; false;
        this.editMode.coverEdit.selectedOption &#x3D; &#x27;UploadCover&#x27;;
        this.PreviewCover(&lt;File&gt;f);
      }
    }
  }

  onSelectPictureFile(event) {
    if (event.target.files &amp;&amp; event.target.files[0]) {
      //this.filesToUpload &#x3D; this.filesToUpload.concat(&lt;Array&lt;File&gt;&gt;event.target.files);
      var filesAmount &#x3D; event.target.files.length;
      let files &#x3D; event.target.files;
      for (let i &#x3D; 0; i &lt; filesAmount; i++) {
        var f &#x3D; files[i];
        // Only process image files.
        if (!f.type.match(&#x27;image.*&#x27;)) {
          continue;
        }
        this.editMode.coverEdit.selectOptions &#x3D; false;
        this.editMode.coverEdit.selectedOption &#x3D; &#x27;UploadPicture&#x27;;
        this.PreviewCover(&lt;File&gt;f);
      }
    }
  }

  UploadCoverFile() {
    var _this &#x3D; this;
    this.imageCompress.uploadFile().then(({ image, orientation }) &#x3D;&gt; {
      _this.processingImage &#x3D; true;
      SysFunctions.getImageCompressionRates(image, &#x27;PAGE_COVER&#x27;).then(rts &#x3D;&gt; {
        this.imageCompress.compressFile(image, orientation, rts.ratio, rts.quality).then(
          result &#x3D;&gt; {
            _this.cover_preview_info &#x3D; { url: &#x27;&#x27;, width: 0, height: 0, file: null, isNew: true };
            _this.editMode.coverEdit.selectOptions &#x3D; false;
            _this.editMode.coverEdit.selectedOption &#x3D; &#x27;UploadCover&#x27;;
            _this.processingImage &#x3D; false;
            _this.PreviewCompressedCover(result, &#x27;base64&#x27;);
          }
        );
      });
    });
  }

  RepositionPageCover(ImgUrl: string) {
    this.cover_preview_info &#x3D; { url: &#x27;&#x27;, width: 0, height: 0, file: null, isNew: true };
    this.editMode.coverEdit.selectOptions &#x3D; false;
    this.editMode.coverEdit.selectedOption &#x3D; &#x27;RepositionCover&#x27;;
    this.PreviewCompressedCover(ImgUrl, &#x27;url&#x27;);
  }

  UploadPictureFile() {
    var _this &#x3D; this;
    this.imageCompress.uploadFile().then(({ image, orientation }) &#x3D;&gt; {
      _this.processingImage &#x3D; true;
      SysFunctions.getImageCompressionRates(image, &#x27;PROFILE_COVER&#x27;).then(rts &#x3D;&gt; {
        this.imageCompress.compressFile(image, orientation, rts.ratio, rts.quality).then(
          result &#x3D;&gt; {
            _this.picture_preview_info &#x3D; { url: &#x27;&#x27;, width: 0, height: 0, file: null, isNew: true };
            _this.editMode.pictureEdit.selectOptions &#x3D; false;
            _this.editMode.pictureEdit.selectedOption &#x3D; &#x27;UploadPicture&#x27;;
            _this.processingImage &#x3D; false;
            _this.PreviewCompressedPicture(result, &#x27;base64&#x27;);
          }
        );
      });
    });
  }

  RepositionPagePicture(ImgUrl: string) {
    this.picture_preview_info &#x3D; { url: &#x27;&#x27;, width: 0, height: 0, file: null, isNew: true };
    this.editMode.pictureEdit.selectOptions &#x3D; false;
    this.editMode.pictureEdit.selectedOption &#x3D; &#x27;RepositionPicture&#x27;;
    this.PreviewCompressedPicture(ImgUrl, &#x27;url&#x27;);
  }

  PreviewCompressedCover(loadedUrl: string, urlType: string) {
    var _this &#x3D; this;
    if (loadedUrl !&#x3D; &#x27;&#x27;) {
      this.loadingImage &#x3D; true;
      this.editMode.coverEdit.processingCover &#x3D; true;
      var loadedImage &#x3D; new Image();
      loadedImage.setAttribute(&#x27;crossorigin&#x27;, &#x27;anonymous&#x27;); // works for me
      var base64Url &#x3D; &#x27;&#x27;;
      loadedImage.onload &#x3D; (event) &#x3D;&gt; {
        if (event) {
          if (urlType &#x3D;&#x3D; &#x27;base64&#x27;) {
            var imgFile &#x3D; SysFunctions.DataUrlToFile(loadedUrl);
            base64Url &#x3D; loadedUrl;
            _this.cover_preview_info &#x3D; { url: base64Url, width: loadedImage.width, height: loadedImage.height, file: imgFile, isNew: true };
            _this.loadingImage &#x3D; false;
          } else {
            SysFunctions.ImageUrlToBlob(loadedUrl).subscribe(blob &#x3D;&gt; {
              SysFunctions.BlobtoDataURL(blob).then(base64Url &#x3D;&gt; {
                var imgFile &#x3D; SysFunctions.DataUrlToFile(base64Url);
                _this.cover_preview_info &#x3D; { url: base64Url, width: loadedImage.width, height: loadedImage.height, file: imgFile, isNew: true };
                _this.loadingImage &#x3D; false;
              });
            });
          }
        }
      }
      loadedImage.src &#x3D; loadedUrl;
    }
    this.editMode.coverEdit.processingCover &#x3D; false;
  }

  PreviewCompressedPicture(loadedUrl: string, urlType: string) {
    var _this &#x3D; this;
    if (loadedUrl !&#x3D; &#x27;&#x27;) {
      this.loadingImage &#x3D; true;
      this.editMode.pictureEdit.processingPicture &#x3D; true;
      var loadedImage &#x3D; new Image();
      loadedImage.setAttribute(&#x27;crossorigin&#x27;, &#x27;anonymous&#x27;); // works for me
      var base64Url &#x3D; &#x27;&#x27;;
      loadedImage.onload &#x3D; (event) &#x3D;&gt; {
        if (event) {
          if (urlType &#x3D;&#x3D; &#x27;base64&#x27;) {
            var imgFile &#x3D; SysFunctions.DataUrlToFile(loadedUrl);
            base64Url &#x3D; loadedUrl;
            _this.picture_preview_info &#x3D; { url: base64Url, width: loadedImage.width, height: loadedImage.height, file: imgFile, isNew: true };
            _this.loadingImage &#x3D; false;
          } else {
            SysFunctions.ImageUrlToBlob(loadedUrl).subscribe(blob &#x3D;&gt; {
              SysFunctions.BlobtoDataURL(blob).then(base64Url &#x3D;&gt; {
                var imgFile &#x3D; SysFunctions.DataUrlToFile(base64Url);
                _this.picture_preview_info &#x3D; { url: base64Url, width: loadedImage.width, height: loadedImage.height, file: imgFile, isNew: true };
                _this.loadingImage &#x3D; false;
              });
            });
          }
        }
      }
      loadedImage.src &#x3D; loadedUrl;
    }
    this.editMode.pictureEdit.processingPicture &#x3D; false;
  }

  PreviewCover(f: File) {
    var fileReader &#x3D; new FileReader();
    var i_url;
    fileReader.onload &#x3D; (e) &#x3D;&gt; {
      if (e) {
        this.editMode.coverEdit.processingCover &#x3D; true;
        i_url &#x3D; (&lt;FileReader&gt;e.target).result;
        var loadedImage &#x3D; new Image();
        loadedImage.onload &#x3D; (event) &#x3D;&gt; {
          if (event) {
            this.cover_preview_info &#x3D; { url: i_url, width: loadedImage.width, height: loadedImage.height, file: &lt;File&gt;f, isNew: true };
          }
        }
        loadedImage.src &#x3D; i_url;
      }
    }
    fileReader.readAsDataURL(&lt;File&gt;f);
    this.editMode.coverEdit.processingCover &#x3D; false;
  }

  /* Top Page Card */
  EditTopPageCard() {
    this.editMode.currentEditing &#x3D; &#x27;topPageCard&#x27;
    this.editMode.inEdit &#x3D; true;
  }

  cancelEditTopPageCard() {
    this.editMode.inEdit &#x3D; false;
    this.editMode.currentEditing &#x3D; &#x27;&#x27;;
  }

  savePageInfo(pageModel: any): Observable&lt;any&gt; {
    var _this &#x3D; this;
    this.errors &#x3D; this.messages &#x3D; [];
    this.provider &#x3D; this.getConfigValue(&#x27;forms.update.provider&#x27;);
    this.service.getProvider(this.provider).crudconfig.route_url &#x3D; &#x27;page/my-page/&#x27;;
    return Observable.create((observer) &#x3D;&gt; {
      this.loadProcessService.submittingData &#x3D; true;
      return this.service.update(this.provider, pageModel, {}).subscribe(result &#x3D;&gt; {
        _this.loadProcessService.submittingData &#x3D; false;
        if (result.isSuccess()) {
          _this.messages &#x3D; result.getMessages();
          var data &#x3D; result.getResultData();
          if (data.done) {
            //_this.UpdateLocalPageInfo(data.page as MyPage);
          }
        } else {
          _this.errors &#x3D; result.getErrors();
        }
      });
    })
  }

  EditPageInfo() {
    this.editMode.currentEditing &#x3D; &#x27;PageInfo&#x27;;
    this.editMode.inEdit &#x3D; true;
  }

  cancelEditPage() {
    this.editMode.inEdit &#x3D; false;
    this.editMode.currentEditing &#x3D; &#x27;&#x27;;
  }

  cancelDeletePage() {
    this.deleteMode.inDelete &#x3D; false;
    this.deleteMode.currentDeleting &#x3D; &#x27;&#x27;;
  }



  isMyPageInEdit(): boolean {
    if (this.urlViewerService.PPVIEWER.page.my_page) {
      return true;
    }
    return false;
  }

  getConfigValue(key: string): any {
    return getDeepFromObject(this.crudconfig, key, null);
  };

}
</code></pre>
    </div>
</div>


                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'EditMode.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
